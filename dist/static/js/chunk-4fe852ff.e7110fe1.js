(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4fe852ff"],{"0b0d":function(e,i,t){"use strict";var r=function(){var e=this,i=e.$createElement,t=e._self._c||i;return t("div",{staticClass:"ih-item"},[t("a",[t("div",[t("img",{style:{height:"200px",border:"3px solid "+this.markcolor},attrs:{src:e.imagesrc},on:{mousedown:e.entermark}})]),t("div",{staticClass:"info",staticStyle:{"{width":"100%"}},[t("h3",{staticStyle:{color:"rgba(255,255,255,1)"}},[e._v(e._s(e.ismarkedtext))])])])])},s=[],n=(t("a9e3"),{name:"",data:function(){return{input:""}},props:{fatherimagesrc:String,ismarked:{type:Number,default:!1},ishighlight:Boolean},destroyed:function(){console.log("miniimageddddddddddddddddddddddddddddddddddddddddddddddddddddd")},computed:{imagesrc:function(){return this.fatherimagesrc},markcolor:function(){return 1===this.ismarked?"#ffffff":2===this.ismarked?"#ff0000":3===this.ismarked?"#ffff00":"#000000"},ismarkedtext:function(){return 2===this.ismarked?"已通过":3===this.ismarked?"已驳回":4===this.ismarked?"已重置":"未审核"}},methods:{kanurl:function(){console.log(this.imagesrc)},entermark:function(){console.log("entermark"),this.$emit("entermark")}},components:{}}),o=n,l=(t("665f"),t("2877")),a=Object(l["a"])(o,r,s,!1,null,null,null);i["a"]=a.exports},1:function(e,i){},"1a17":function(e,i,t){},2:function(e,i){},3:function(e,i){},6125:function(e,i,t){},"665f":function(e,i,t){"use strict";t("e454")},"77c4":function(e,i,t){"use strict";t.d(i,"d",(function(){return s})),t.d(i,"e",(function(){return n})),t.d(i,"c",(function(){return o})),t.d(i,"b",(function(){return l})),t.d(i,"a",(function(){return a})),t.d(i,"g",(function(){return c})),t.d(i,"h",(function(){return h})),t.d(i,"i",(function(){return f})),t.d(i,"f",(function(){return u}));var r=t("b775");function s(e){return Object(r["a"])({url:"/8085/userAudit/getAudits",method:"get",params:e})}function n(e){return Object(r["a"])({url:"/8085/userAudit/getAuditData",method:"get",params:e})}function o(e){return Object(r["a"])({url:"/8085/userAudit/batchSave",method:"put",params:e})}function l(e){return Object(r["a"])({url:"/8085/userAudit/batchReject",method:"put",params:e})}function a(e){return Object(r["a"])({url:"/8085/userAudit/batchReSet",method:"put",params:e})}function c(e){return Object(r["a"])({url:"/8085/userAudit/isAudit",method:"put",params:e})}function h(e){return Object(r["a"])({url:"/8085/userAudit/isReSet",method:"put",params:e})}function f(e){return Object(r["a"])({url:"/8085/userAudit/isReject",method:"put",params:e})}function u(e){return Object(r["a"])({url:"/8085/userAudit/getAudit",method:"get",params:e})}},"7e1e":function(e,i,t){"use strict";t.d(i,"f",(function(){return s})),t.d(i,"c",(function(){return n})),t.d(i,"e",(function(){return o})),t.d(i,"h",(function(){return l})),t.d(i,"i",(function(){return a})),t.d(i,"a",(function(){return c})),t.d(i,"m",(function(){return h})),t.d(i,"k",(function(){return f})),t.d(i,"b",(function(){return u})),t.d(i,"l",(function(){return d})),t.d(i,"j",(function(){return g})),t.d(i,"d",(function(){return p}));var r=t("b775");function s(e){return Object(r["a"])({url:"/8085/data/getAssignedData",method:"get",params:e})}function n(e){return Object(r["a"])({url:"/8085/data/create",method:"post",params:e})}function o(e){return Object(r["a"])({url:"/8089/dataset/delete",method:"delete",params:e})}function l(e){return Object(r["a"])({url:"/8085/userlabel/getAll",method:"get",params:e})}function a(e){return Object(r["a"])({url:"/8085/userlabel/getLabel",method:"get",params:e})}function c(e){return Object(r["a"])({url:"/8085/userlabel/assignLabel",method:"post",params:e})}function h(e){return Object(r["a"])({url:"/8085/label/fresh",method:"put",params:e})}function f(e){return Object(r["a"])({url:"/8085/tag/get",method:"get",params:e})}function u(e){return Object(r["a"])({url:"/8085/userlabel/assignNewData",method:"post",params:e})}function d(e){return Object(r["a"])({url:"/8085/userlabel/reAssign",method:"post",params:e})}function g(e){return Object(r["a"])({url:"/8085/userlabel/getNewLabel",method:"get",params:e})}function p(e){return Object(r["a"])({url:"/8085/teamdataset/delTeam",method:"delete",params:e})}},"80ab":function(e,i,t){"use strict";t.r(i);var r=function(){var e=this,i=e.$createElement,t=e._self._c||i;return t("div",{staticStyle:{"user-select":"none"}},[e.isimageview?t("div",{staticClass:"dashboard-container"},[t("div",[t("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:e.returndataset}},[e._v("返回数据集")]),t("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:e.batchSave}},[e._v("批量通过")]),t("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:e.batchRejectDialog}},[e._v("批量不通过")]),t("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:e.batchReSet}},[e._v("批量重置")]),t("span",{staticClass:"checkAll"},[t("input",{attrs:{type:"checkbox"},domProps:{checked:e.checkedList.length===e.imagelargeArry.length},on:{change:function(i){return e.checkedAll()}}}),t("span",[e._v("全选")])])],1),e._l(e.imagelargeArry,(function(i,r){return t("div",{key:r,staticStyle:{display:"inline-block","margin-left":"20px"}},[t("div",[t("div",{staticStyle:{"margin-top":"20px"}},[t("input",{attrs:{type:"checkbox",name:""},domProps:{checked:-1!=e.checkedList.indexOf(i.uuid)},on:{change:function(t){return e.addToList(i.uuid)}}})]),t("miniimage",{staticStyle:{"margin-top":"1px"},attrs:{fatherimagesrc:i.url,ismarked:i.islabel},on:{entermark:function(i){return e.entermark(r)}}})],1)])}))],2):e._e(),e.isimageview?e._e():t("div",{staticClass:"dashboard-container",staticStyle:{"margin-left":"100px"}},[t("el-button",{attrs:{disabled:e.isdisablebutton},on:{click:e.returnimageview}},[e._v("返回图片预览")]),t("el-button",{attrs:{disabled:e.isdisablebutton},on:{click:e.nextimage}},[e._v("下一张(N)")]),t("el-button",{attrs:{disabled:e.isdisablebutton},on:{click:e.previousimage}},[e._v("上一张(P)")]),t("el-button",{on:{click:e.pass}},[e._v("通过(A)")]),t("el-button",{on:{click:e.rejectDialog}},[e._v("驳回(D)")]),t("el-button",{on:{click:e.reset}},[e._v("重置(G)")]),t("drawpolygon",{ref:"drawpolygonref",staticStyle:{"margin-top":"20px"},attrs:{fatherimagesrc:this.imageArry[e.nownum],imageindex:this.nownum,premarktype:this.marktype,auditremakeinfo:this.auditinfoArry[e.nownum],acceptremakeinfo:this.acceptinfoArry[e.nownum],lastlabelArry:this.lastinfoArry[e.nownum]}})],1),t("el-dialog",{attrs:{title:"驳回备注",visible:e.batchRejectDiaglogShow,width:"30%"},on:{"update:visible":function(i){e.batchRejectDiaglogShow=i}}},[t("el-input",{attrs:{placeholder:"请输入备注",clearable:""},model:{value:e.auditRemarks,callback:function(i){e.auditRemarks=i},expression:"auditRemarks"}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(i){e.batchRejectDiaglogShow=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.submitBatchReject}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"驳回备注",visible:e.rejectDiaglogShow,width:"30%"},on:{"update:visible":function(i){e.rejectDiaglogShow=i}}},[t("el-input",{attrs:{placeholder:"请输入备注",clearable:""},model:{value:e.auditRemark,callback:function(i){e.auditRemark=i},expression:"auditRemark"}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(i){e.rejectDiaglogShow=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.submitReject}},[e._v("确 定")])],1)],1)],1)},s=[],n=t("5530"),o=t("1da1"),l=(t("96cf"),t("a434"),t("159b"),t("a15b"),t("b0c0"),t("2f62")),a=(t("7e1e"),function(){var e=this,i=e.$createElement,t=e._self._c||i;return t("div",{staticClass:"polygon-body",staticStyle:{width:"100%"}},[t("div",[t("div",{style:{marginLeft:(this.divWidth-250)/2+"px",display:"block"}},[t("el-button-group",{staticStyle:{display:"inline-block"}},[t("el-button",{style:{width:"80px"},attrs:{icon:"el-icon-zoom-in"},on:{click:e.fangda}}),t("el-button",{style:{width:"80px"},attrs:{icon:"el-icon-zoom-out"},on:{click:e.suoxiao}}),t("el-button",{style:{width:"80px"},attrs:{icon:"el-icon-refresh"},on:{click:e.huanyuan}})],1)],1)]),t("div",{style:{display:"flex"}},[t("div",{ref:"outdiv",style:{maxWidth:"1000px",maxHeight:"1000px"},attrs:{id:"leftdiv"}},[t("div",{staticClass:"polygon",style:{},on:{mouseenter:e.fangdasuoxiaochange1,mouseleave:e.fangdasuoxiaochange2,mousewheel:function(e){e.preventDefault()}}},[t("canvas",{staticClass:"canvas",attrs:{id:"label-canvas"}})]),t("div",{staticStyle:{display:"inline-block"},attrs:{id:"remarkinfodiv"}},[t("div",[t("p",[e._v("驳回备注："+e._s(e.auditremakeinfo))])]),t("div",[t("p",[e._v("验收备注："+e._s(e.acceptremakeinfo))])])])]),t("div",{staticClass:"el-divider el-divider--vertical"}),t("div",{attrs:{id:"rightdiv"}},[t("el-divider"),t("div",{ref:"infodiv",staticClass:"infopolygon",style:e.setheightInfo},e._l(e.allobjArray,(function(i,r){return t("div",{key:r,staticStyle:{"margin-right":"20px"}},[t("div",{style:{width:"400px",height:"160px",marginTop:"10px",border:e.b_i===r?"3px solid #ff0000":"0px solid #ff0000",background:i.color},on:{mousedown:function(t){return e.handelClick(i,r)}}},[t("div",{staticStyle:{width:"300px","margin-top":"10px",display:"inline-block"}},[t("p",{style:{marginLeft:"30px",marginTop:"10px",width:"300px",fontSize:"20px",display:"inline-block"}},[e._v(" "+e._s("polygon"==i.type?"多边形":"line"==i.type?"线":"point"==i.type?"点":"rectangle"==i.type?"矩形":"椭圆形")+" "+e._s(i.info)+" ")])])])])})),0)],1)])])}),c=[],h=t("53ca"),f=(t("a9e3"),t("7a94")),u={props:{fatherimagesrc:String,imageindex:Number,premarktype:{type:Array,default:function(){return[]}},auditremakeinfo:{type:String,default:""},acceptremakeinfo:{type:String,default:""},lastlabelArry:{type:Object,default:function(){}},canvaswidth:{type:Number,default:600},canvasheight:{type:Number,default:600}},data:function(){return{divWidth:1e3,divHeight:750,mountedFlag:!0,setheightTag:{marginTop:"20px",marginLeft:"20px",height:""},setheightInfo:{marginLeft:"20px",height:""},radio:"polygonmark",markstyle:!0,dialogVisible:!1,dialogleft:0,dialogtop:0,markcolor2:"rgba(0,128,128,0.5)",markinfo2:null,mousePointerEvent:null,b_i:"",allowchangebi:!0,lockradio:!1,temitem:null,fangdasuoxiaoFlag:!1,buttonindex:-1,input:null,temproof:null,roof:null,line:null,cicle:null,rectangle:null,ellipse:null,panning:!1,zoom:1,islabeling:!1,allobjArray:[],temtwopoint:[],testcirclearray:[],generateline:[],temlineobj:null,imagechangebtntext:"修改图形",isimagechange:!1,imagewidth:null,imageheight:null,scalewidth:null,scaleheight:null,distanceDelta:0,linePoints:[],realLinePoints:[],circlePoints:[],rectanglePoints:[],ellipsePoints:[],realCirclePoints:[],roofPoints:[],realPoints:[],realRectanglePoints:[],realEllipsePoints:[],temRectangle:[],temEllipse:[],temlines:[],temlineCounter:0,temcircles:[],temcircleCounter:0,llines:[],llinesCounter:0,lineArray:[],lineinfoArray:[],reallineinfoArray:[],circleArray:[],circleinfoArray:[],realcircleinfoArray:[],polygonArray:[],polygoninfoArray:[],realpolygoninfoArray:[],rectangleArray:[],rectangleinfoArray:[],realrectangleinfoArray:[],ellipseArray:[],ellipseinfoArray:[],realellipseinfoArray:[],fabricObj:null,fabricimageObj:null,canvas:null,Point:{},markcolor:"rgba(0,128,128,0.5)",markinfo:null,buttonmouseoveflag:!1}},computed:{imagesrc:function(){return this.fatherimagesrc}},destroyed:function(){window.removeEventListener("resize",this.GetWindowInfo),window.removeEventListener("mousewheel",this.checkFangdasSuoxiao)},mounted:function(){var e=this;window.addEventListener("resize",this.GetWindowInfo),window.addEventListener("mousewheel",this.checkFangdasSuoxiao,!0),this.GetWindowInfo(),this.mountedFlag=!1,this.$nextTick((function(){setTimeout((function(){e.fabricObj=new f["fabric"].Canvas("label-canvas"),e.fabricObj.selection=!1,e.fabricEvent(),e.createBackgroundImage()}),500),setTimeout((function(){e.updatelastdata(),console.log("wwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww",e.fabricObj.width),e.huanyuan()}),520),setTimeout((function(){e.GetWindowInfo()}),550)}))},watch:{imagesrc:function(){var e=this;console.log("watch!!!!!!!!"),this.buttonindex=-1,this.createBackgroundImage(),setTimeout((function(){e.polygonArray.forEach((function(i){e.fabricObj.remove(i)})),e.lineArray.forEach((function(i){e.fabricObj.remove(i)})),e.circleArray.forEach((function(i){e.fabricObj.remove(i)})),e.rectangleArray.forEach((function(i){e.fabricObj.remove(i)})),e.ellipseArray.forEach((function(i){e.fabricObj.remove(i)})),e.clearinfo(),e.clearobj(),e.markinfo=null,e.isimagechange&&e.Edit(),e.updatelastdata(),e.huanyuan(),e.buttonindex=-1}),20)}},methods:{handelClick:function(e,i){this.allowchangebi&&(this.b_i!=i?(this.b_i=i,this.getBorder(e)):(this.deleteBorder(e),this.b_i=-1)),console.log("hahaha"+e.type)},getBorder:function(e){if(this.temitem=e,"polygon"==e.type){var i=this.polygonArray.indexOf(e),t=this.fabricObj.getObjects()[this.fabricObj._objects.indexOf(this.polygonArray[i])];console.log(i,t),t.hasBorders=!0,t.hasControls=!1,t.selectable=!1,t.set({lockMovementX:!0,lockMovementY:!0}),this.fabricObj.setActiveObject(t),this.fabricObj.renderAll()}else if("line"==e.type){var r=this.lineArray.indexOf(e),s=this.fabricObj.getObjects()[this.fabricObj._objects.indexOf(this.lineArray[r])];console.log(r,s),s.hasBorders=!0,s.hasControls=!1,s.selectable=!1,s.set({lockMovementX:!0,lockMovementY:!0}),this.fabricObj.setActiveObject(s),this.fabricObj.renderAll()}else if("point"==e.type){var n=this.circleArray.indexOf(e),o=this.fabricObj.getObjects()[this.fabricObj._objects.indexOf(this.circleArray[n])];console.log(n,o),o.hasBorders=!0,o.hasControls=!1,o.selectable=!1,o.set({lockMovementX:!0,lockMovementY:!0}),this.fabricObj.setActiveObject(o),this.fabricObj.renderAll()}else if("rectangle"==e.type){var l=this.rectangleArray.indexOf(e),a=this.fabricObj.getObjects()[this.fabricObj._objects.indexOf(this.rectangleArray[l])];console.log(l,a),a.hasBorders=!0,a.hasControls=!1,a.selectable=!1,a.set({lockMovementX:!0,lockMovementY:!0}),this.fabricObj.setActiveObject(a),this.fabricObj.renderAll()}else if("ellipse"==e.type){var c=this.ellipseArray.indexOf(e),h=this.fabricObj.getObjects()[this.fabricObj._objects.indexOf(this.ellipseArray[c])];console.log(c,h),h.hasBorders=!0,h.hasControls=!1,h.selectable=!1,h.set({lockMovementX:!0,lockMovementY:!0}),this.fabricObj.setActiveObject(h),this.fabricObj.renderAll()}},deleteBorder:function(e){if(this.temitem=null,"polygon"==e.type){var i=this.polygonArray.indexOf(e),t=this.fabricObj.getObjects()[this.fabricObj._objects.indexOf(this.polygonArray[i])];console.log(i,t),t.hasBorders=!1,t.hasControls=!0,t.selectable=!1,t.set({lockMovementX:!0,lockMovementY:!0}),this.fabricObj.discardActiveObject(t),this.fabricObj.renderAll()}else if("line"==e.type){var r=this.lineArray.indexOf(e),s=this.fabricObj.getObjects()[this.fabricObj._objects.indexOf(this.lineArray[r])];console.log(r,s),s.hasBorders=!1,s.hasControls=!1,s.selectable=!1,s.set({lockMovementX:!0,lockMovementY:!0}),this.fabricObj.discardActiveObject(s),this.fabricObj.renderAll()}else if("point"==e.type){var n=this.circleArray.indexOf(e),o=this.fabricObj.getObjects()[this.fabricObj._objects.indexOf(this.circleArray[n])];console.log(n,o),o.hasBorders=!1,o.hasControls=!1,o.selectable=!1,o.set({lockMovementX:!1,lockMovementY:!1}),this.fabricObj.discardActiveObject(o),this.fabricObj.renderAll()}else if("rectangle"==e.type){var l=this.rectangleArray.indexOf(e),a=this.fabricObj.getObjects()[this.fabricObj._objects.indexOf(this.rectangleArray[l])];console.log(l,a),a.hasBorders=!1,a.hasControls=!0,a.selectable=!1,a.set({lockMovementX:!1,lockMovementY:!1}),this.fabricObj.discardActiveObject(a),this.fabricObj.renderAll()}else if("ellipse"==e.type){var c=this.ellipseArray.indexOf(e),h=this.fabricObj.getObjects()[this.fabricObj._objects.indexOf(this.ellipseArray[c])];console.log(c,h),h.hasBorders=!1,h.hasControls=!0,h.selectable=!1,h.set({lockMovementX:!1,lockMovementY:!1}),this.fabricObj.discardActiveObject(h),this.fabricObj.renderAll()}},fangdasuoxiaochange1:function(){console.log("enter!!!!!"),this.fangdasuoxiaoFlag=!0},fangdasuoxiaochange2:function(){console.log("leave!!!!!"),this.fangdasuoxiaoFlag=!1},checkFangdasSuoxiao:function(e){var i=e.deltaY>0?"down":"up";this.fangdasuoxiaoFlag&&("up"==i?this.fangda():this.suoxiao())},GetWindowInfo:function(){window.innerWidth>1650?this.divWidth=1e3:window.innerWidth>800?this.divWidth=1e3-(1650-window.innerWidth):this.divWidth=500,window.innerHeight>930?this.divHeight=750:window.innerHeight>450?this.divHeight=750-(930-window.innerHeight):this.divHeight=375,this.mountedFlag||(this.fabricObj.setWidth(this.divWidth),this.fabricObj.setHeight(this.divHeight),this.setheightTag.height=.25*this.divHeight+"px",this.setheightInfo.height=.75*this.divHeight+"px",console.log("asduisafhiasfb",this.divHeight))},clearobj:function(){var e=this;this.islabeling&&(this.islabeling=!1),this.temlines.forEach((function(i){return e.fabricObj.remove(i)})),this.temcircles.forEach((function(i){return e.fabricObj.remove(i)})),this.llines.forEach((function(i){return e.fabricObj.remove(i)})),this.temRectangle.forEach((function(i){return e.fabricObj.remove(i)})),this.temEllipse.forEach((function(i){return e.fabricObj.remove(i)})),this.roofPoints=[],this.realPoints=[],this.linePoints=[],this.realLinePoints=[],this.rectanglePoints=[],this.realRectanglePoints=[],this.ellipsePoints=[],this.realEllipsePoints=[],this.temlines=[],this.temcircles=[],this.llines=[],this.temRectangle=[],this.temEllipse=[],this.temlineCounter=0,this.temcircleCounter=0,this.b_i=-1,console.log("count",this.testcirclearray.length,"objarr",this.testcirclearray),this.testcirclearray.length%2==1&&this.testcirclearray.length>0&&(console.log("delete one"),this.testcirclearray.pop())},clearinfo:function(){this.allobjArray=[],this.polygonArray=[],this.polygoninfoArray=[],this.realpolygoninfoArray=[],this.lineArray=[],this.lineinfoArray=[],this.reallineinfoArray=[],this.circleArray=[],this.circleinfoArray=[],this.realcircleinfoArray=[],this.rectangleArray=[],this.rectangleinfoArray=[],this.realrectangleinfoArray=[],this.ellipseArray=[],this.ellipseinfoArray=[],this.realellipseinfoArray=[],this.testcirclearray=[]},fangda:function(){var e=new f["fabric"].Point(this.divWidth/2,this.divHeight/2);this.zoom<4.99&&(this.zoom+=.1),this.fabricObj.zoomToPoint(e,this.zoom)},suoxiao:function(){var e=new f["fabric"].Point(this.divWidth/2,this.divHeight/2);this.zoom>.2&&(this.zoom-=.1),this.zoom>.1&&this.fabricObj.zoomToPoint(e,this.zoom)},huanyuan:function(){this.zoom=1,this.fabricObj.setZoom(1);var e=new f["fabric"].Point(0,0);this.fabricObj.absolutePan(e),this.fabricObj.relativePan(this.distanceDelta)},updatelastdata:function(){var e=this;if(console.log("image select lastlabelArry",this.lastlabelArry),console.log("remarkinfo",this.auditremakeinfo,this.acceptremakeinfo),this.b_i=-1,console.log("img11111111111111111",this.scalewidth,this.scaleheight),void 0!=this.lastlabelArry.line&&null!=this.lastlabelArry.line)for(var i=0;i<this.lastlabelArry.line.length;i++){for(var t=0;t<this.lastlabelArry.line[i].point.length;t++){console.log("point",this.lastlabelArry.line[i].point[t]);var r={},s={};r["x"]=this.lastlabelArry.line[i].point[t].x*this.scalewidth,r["y"]=this.lastlabelArry.line[i].point[t].y*this.scaleheight,s["x"]=this.lastlabelArry.line[i].point[t].x,s["y"]=this.lastlabelArry.line[i].point[t].y,this.linePoints.push(r),this.realLinePoints.push(s),this.makeLineEndPoint(r)}this.markinfo=this.lastlabelArry.line[i].info,this.findcolor(this.lastlabelArry.line[i].info),this.lineinfoArray.push({point:this.linePoints,info:this.markinfo}),this.reallineinfoArray.push({point:this.realLinePoints,info:this.markinfo}),console.log("linePoints",this.linePoints),this.makeLine(this.linePoints),this.fabricObj.add(this.line),this.lineArray.push(this.line),this.allobjArray.push(this.line),this.linePoints=[],this.realLinePoints=[],this.markinfo=null}if(void 0!=this.lastlabelArry.polygon&&null!=this.lastlabelArry.polygon)for(var n=0;n<this.lastlabelArry.polygon.length;n++){this.realpolygoninfoArray.push(this.lastlabelArry.polygon[n]),this.markinfo=this.lastlabelArry.polygon[n].info,console.log("lastlabelArry[i].point",this.lastlabelArry.polygon[n].point);for(var o=0;o<this.lastlabelArry.polygon[n].point.length;o++){console.log("point",this.lastlabelArry.polygon[n].point[o]);var l={};l["x"]=this.lastlabelArry.polygon[n].point[o].x*this.scalewidth,l["y"]=this.lastlabelArry.polygon[n].point[o].y*this.scaleheight,this.roofPoints.push(l)}console.log("roofPoint",this.roofPoints),console.log("this.lastlabelArry[i].info",this.lastlabelArry.polygon[n].info),this.findcolor(this.lastlabelArry.polygon[n].info),this.makeRoof(),console.log("this.roof",this.roof),this.fabricObj.add(this.roof),this.polygonArray.push(this.roof),this.allobjArray.push(this.roof),this.polygoninfoArray.push({point:this.roofPoints,info:this.markinfo}),this.markinfo=null,console.log("create 1"),console.log("roofPointsuuu",this.roofPoints),this.roofPoints=[]}if(void 0!=this.lastlabelArry.rectangle&&null!=this.lastlabelArry.rectangle)for(var a=0;a<this.lastlabelArry.rectangle.length;a++){console.log("rectangle1",this.lastlabelArry.rectangle[a]);for(var c=0;c<this.lastlabelArry.rectangle[a].point.length;c++){console.log("rectangle2",this.lastlabelArry.rectangle[a].point[c]);var h={},u={};h["x"]=this.lastlabelArry.rectangle[a].point[c].x*this.scalewidth,h["y"]=this.lastlabelArry.rectangle[a].point[c].y*this.scaleheight,u["x"]=this.lastlabelArry.rectangle[a].point[c].x,u["y"]=this.lastlabelArry.rectangle[a].point[c].y,this.rectanglePoints.push(h),this.realRectanglePoints.push(u)}this.markinfo=this.lastlabelArry.rectangle[a].info,this.findcolor(this.lastlabelArry.rectangle[a].info),this.makeRectangle(),this.rectangleArray.push(this.rectangle),this.allobjArray.push(this.rectangle),this.rectangleinfoArray.push({point:this.rectanglePoints,info:this.markinfo}),this.realrectangleinfoArray.push({point:this.realRectanglePoints,info:this.markinfo}),this.fabricObj.add(this.rectangle),this.rectanglePoints=[],this.realRectanglePoints=[],this.rectangle=null}if(void 0!=this.lastlabelArry.ellipse&&null!=this.lastlabelArry.ellipse)for(var d=0;d<this.lastlabelArry.ellipse.length;d++){console.log("ellipse1",this.lastlabelArry.ellipse[d]);for(var g=0;g<this.lastlabelArry.ellipse[d].point.length;g++){console.log("ellipse2",this.lastlabelArry.ellipse[d].point[g]);var p={},y={};p["x"]=this.lastlabelArry.ellipse[d].point[g].x*this.scalewidth,p["y"]=this.lastlabelArry.ellipse[d].point[g].y*this.scaleheight,y["x"]=this.lastlabelArry.ellipse[d].point[g].x,y["y"]=this.lastlabelArry.ellipse[d].point[g].y,this.ellipsePoints.push(p),this.realEllipsePoints.push(y)}this.markinfo=this.lastlabelArry.ellipse[d].info,this.findcolor(this.lastlabelArry.ellipse[d].info),this.makeEllipse(),this.ellipseArray.push(this.ellipse),this.allobjArray.push(this.ellipse),this.ellipseinfoArray.push({point:this.ellipsePoints,info:this.markinfo}),this.realellipseinfoArray.push({point:this.realEllipsePoints,info:this.markinfo}),this.fabricObj.add(this.ellipse),this.ellipsePoints=[],this.realEllipsePoints=[],this.ellipse=null}if(void 0!=this.lastlabelArry.circle&&null!=this.lastlabelArry.circle)for(var b=function(i){console.log("circle",e.lastlabelArry.circle[i].point),e.markinfo=e.lastlabelArry.circle[i].info,e.findcolor(e.lastlabelArry.circle[i].info);var t={},r={};t["x"]=e.lastlabelArry.circle[i].point.x*e.scalewidth,t["y"]=e.lastlabelArry.circle[i].point.y*e.scaleheight,r["x"]=e.lastlabelArry.circle[i].point.x,r["y"]=e.lastlabelArry.circle[i].point.y;var s=new f["fabric"].Circle({radius:5,fill:e.markcolor,selectable:!1,hasBorders:!1,hasControls:!1,borderColor:"red",top:t.y-5,left:t.x-5});s.on("moved",(function(){console.log("aisojfgyaigvy7a98g",e.circleinfoArray[e.circleArray.indexOf(s)]),e.circleinfoArray[e.circleArray.indexOf(s)].point.x=s.left+5,e.circleinfoArray[e.circleArray.indexOf(s)].point.y=s.top+5,e.realcircleinfoArray[e.circleArray.indexOf(s)].point.x=(s.left+5)/e.scalewidth,e.realcircleinfoArray[e.circleArray.indexOf(s)].point.y=(s.top+5)/e.scaleheight})),s.type="point",s.color=e.markcolor,s.info=e.markinfo,e.circleArray.push(s),e.allobjArray.push(s),e.fabricObj.add(s),e.circleinfoArray.push({point:t,info:e.markinfo}),e.realcircleinfoArray.push({point:r,info:e.markinfo}),e.markinfo=null},m=0;m<this.lastlabelArry.circle.length;m++)b(m);this.fabricObj.renderAll(),this.fabricObj.hoverCursor="default",console.log("fabricobjuuu",this.fabricObj),console.log("polygonArrayuuu",this.polygonArray),console.log("polygoninfoArrayuuu",this.polygoninfoArray),console.log("realpolygoninfoArrayuuu",this.realpolygoninfoArray),console.log("realPointsuuu",this.realPoints),console.log("temlinesuuu",this.temlines),console.log("temlineCounteruuu",this.temlineCounter),console.log("lineArrayuuu",this.lineArray),console.log("lineinfoArrayuuu",this.lineinfoArray),console.log("reallineinfoArrayuuu",this.reallineinfoArray),console.log("circlearray",this.circleArray),console.log("circleinfoarray",this.circleinfoArray),console.log("realcircleinfoarray",this.realcircleinfoArray),console.log("polygonArrayuuu",this.polygonArray),console.log("polygonArrayuuu",this.polygonArray),console.log("polygonArrayuuu",this.polygonArray),console.log("allobjArrayuuu",this.allobjArray)},createBackgroundImage:function(){var e=this;console.log(this.imagesrc),void 0!==this.imagesrc&&null!==this.imagesrc&&(this.fabricimageObj=new f["fabric"].Image.fromURL(this.imagesrc,(function(i){if(e.imagewidth=i.width,e.imageheight=i.height,e.scalewidth=1,e.scaleheight=1,i.width<.8*e.divWidth&&i.height<.8*e.divHeight)while(e.imagewidth<.8*e.divWidth&&e.imageheight<.8*e.divHeight)e.imagewidth*=1.1,e.imageheight*=1.1,e.scalewidth*=1.1,e.scaleheight*=1.1;if(i.width>e.divWidth||i.height>e.divHeight)while(e.imagewidth>e.divWidth||e.imageheight>e.divHeight)e.imagewidth/=1.1,e.imageheight/=1.1,e.scalewidth/=1.1,e.scaleheight/=1.1;e.distanceDelta=new f["fabric"].Point((e.divWidth-e.imagewidth)/2,(e.divHeight-e.imageheight)/2),e.fabricObj.setWidth(e.divWidth),e.fabricObj.setHeight(e.divHeight),console.log(i.width),console.log(i.height),console.log(e.imagewidth),console.log(e.imageheight),console.log(e.fabricObj.width),console.log(e.fabricObj.height),console.log(e.scalewidth),console.log(e.scaleheight),i.set({scaleX:e.scalewidth,scaleY:e.scaleheight,selectable:!0,hasControls:!1,left:0,top:0}),e.fabricObj.setBackgroundImage(i,e.fabricObj.renderAll.bind(e.fabricObj))})))},fabricEvent:function(){var e=this;this.fabricObj.on({"mouse:down":function(i){console.log("1111"),e.panning=!0},"mouse:move":function(i){if(e.panning&&i&&i.e){var t=new f["fabric"].Point(i.e.movementX,i.e.movementY);e.fabricObj.relativePan(t)}},"mouse:up":function(i){console.log("upupup"),e.panning=!1}})},makePolygon:function(){var e=this;this.temlines.forEach((function(i){return e.fabricObj.remove(i)})),this.temcircles.forEach((function(i){return e.fabricObj.remove(i)})),this.roofPoints.length>2&&(this.makeRoof(),console.log(this.roof),this.fabricObj.add(this.roof),this.polygonArray.push(this.roof),this.allobjArray.push(this.roof),this.polygoninfoArray.push({point:this.roofPoints,info:this.markinfo}),this.realpolygoninfoArray.push({point:this.realPoints,info:this.markinfo})),this.fabricObj.renderAll(),console.log("double click"),this.roofPoints=[],this.realPoints=[],this.temlines=[],this.temcircles=[],this.temlineCounter=0,this.temcircleCounter=0},makeRoof:function(){var e=this.findLeftPaddingForRoof(this.roofPoints),i=this.findTopPaddingForRoof(this.roofPoints);console.log("!!!roofPoint",this.roofPoints),console.log("!!!fabricObj",this.fabricObj),this.roof=new f["fabric"].Polygon(this.roofPoints,{fill:this.markcolor,strokeWidth:5,selectable:!1,hasBorders:!1,borderColor:"red",lockMovementX:!0,lockMovementY:!0,objectCaching:!1,transparentCorners:!1,left:e,top:i}),this.roof.type="polygon",this.roof.color=this.markcolor,this.roof.info=this.markinfo,console.log("create!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!",this.roof)},makeLineObj:function(e){if(e.absolutePointer.x!=this.linePoints[0].x||e.absolutePointer.y!=this.linePoints[0].y){var i={},t={};i["x"]=e.absolutePointer.x,i["y"]=e.absolutePointer.y,t["x"]=e.absolutePointer.x/this.scalewidth,t["y"]=e.absolutePointer.y/this.scaleheight,this.linePoints.push(i),this.realLinePoints.push(t),this.makeLineEndPoint(i),this.makeLine(this.linePoints),this.lineArray.push(this.line),this.allobjArray.splice(this.lineArray.length-1,0,this.line),this.lineinfoArray.push({point:this.linePoints,info:this.markinfo}),this.reallineinfoArray.push({point:this.realLinePoints,info:this.markinfo}),this.fabricObj.remove(this.llines[0]),this.fabricObj.add(this.line),console.log("this.fabricObj._objects",this.fabricObj._objects);for(var r=0;r<this.polygonArray.length+this.circleArray.length+this.rectangleArray.length;r++)this.fabricObj.getObjects()[this.fabricObj._objects.indexOf(this.line)].sendBackwards();this.fabricObj.renderAll(),this.linePoints=[],this.realLinePoints=[],this.line=null,this.llines=[],console.log("linearray",this.lineArray),console.log("lineinfoarray",this.lineinfoArray),console.log("reallineinfoarray",this.reallineinfoArray),console.log("llinesttttt",this.llines[0]),this.islabeling&&(this.islabeling=!1)}else console.log("click repeat!!!")},makeLine:function(e){console.log("alinePoints",e);var i=[e[0].x,e[0].y,e[1].x,e[1].y];this.line=new f["fabric"].Line(i,{strokeWidth:3,selectable:!1,hasBorders:!1,hasControls:!1,borderColor:"red",stroke:this.markcolor}),this.line.type="line",this.line.color=this.markcolor,this.line.info=this.markinfo,console.log("this.line",this.line)},makeLineEndPoint:function(e){var i=this,t=new f["fabric"].Circle({radius:5,fill:"green",selectable:!0,hasBorders:!1,hasControls:!1,top:e.y-5,left:e.x-5});t.bringToFront(),this.testcirclearray.length%2==0?(t.on("moving",(function(){i.lineArray[i.testcirclearray.indexOf(t)/2].set({x1:t.left+5,y1:t.top+5})})),t.on("moved",(function(){i.lineinfoArray[i.testcirclearray.indexOf(t)/2].point[0].x=t.left+5,i.lineinfoArray[i.testcirclearray.indexOf(t)/2].point[0].y=t.top+5,i.reallineinfoArray[i.testcirclearray.indexOf(t)/2].point[0].x=(t.left+5)/i.scalewidth,i.reallineinfoArray[i.testcirclearray.indexOf(t)/2].point[0].y=(t.top+5)/i.scaleheight}))):(t.on("moving",(function(){i.lineArray[(i.testcirclearray.indexOf(t)-1)/2].set({x2:t.left+5,y2:t.top+5})})),t.on("moved",(function(){i.lineinfoArray[(i.testcirclearray.indexOf(t)-1)/2].point[1].x=t.left+5,i.lineinfoArray[(i.testcirclearray.indexOf(t)-1)/2].point[1].y=t.top+5,i.reallineinfoArray[(i.testcirclearray.indexOf(t)-1)/2].point[1].x=(t.left+5)/i.scalewidth,i.reallineinfoArray[(i.testcirclearray.indexOf(t)-1)/2].point[1].y=(t.top+5)/i.scaleheight}))),this.testcirclearray.push(t)},makePointObj:function(e){var i=this;console.log("4444");var t={},r={};t["x"]=e.absolutePointer.x,t["y"]=e.absolutePointer.y,r["x"]=e.absolutePointer.x/this.scalewidth,r["y"]=e.absolutePointer.y/this.scaleheight;var s=new f["fabric"].Circle({radius:5,fill:this.markcolor,selectable:!1,hasBorders:!1,hasControls:!1,borderColor:"red",top:t.y-5,left:t.x-5});s.on("moved",(function(){i.circleinfoArray[i.circleArray.indexOf(s)].x=s.left+5,i.circleinfoArray[i.circleArray.indexOf(s)].y=s.top+5,i.realcircleinfoArray[i.circleArray.indexOf(s)].x=(s.left+5)/i.scalewidth,i.realcircleinfoArray[i.circleArray.indexOf(s)].y=(s.top+5)/i.scaleheight})),s.type="point",s.color=this.markcolor,s.info=this.markinfo,this.circleArray.push(s),this.allobjArray.push(s),this.circleinfoArray.push({point:t,info:this.markinfo}),this.realcircleinfoArray.push({point:r,info:this.markinfo}),this.fabricObj.add(s),this.fabricObj.renderAll(),console.log("circlearray",this.circleArray),console.log("circleinfoarray",this.circleinfoArray),console.log("realcircleinfoarray",this.realcircleinfoArray)},makeRectangleObj:function(e){if(e.absolutePointer.x!=this.rectanglePoints[0].x||e.absolutePointer.y!=this.rectanglePoints[0].y){console.log("dasiogfu890asdguyqehn fbewjkb fwekjb wef e eq");var i={},t={};i["x"]=e.absolutePointer.x,i["y"]=e.absolutePointer.y,t["x"]=e.absolutePointer.x/this.scalewidth,t["y"]=e.absolutePointer.y/this.scaleheight,this.rectanglePoints.push(i),this.realRectanglePoints.push(t),this.makeRectangle(),this.rectangleArray.push(this.rectangle),this.allobjArray.push(this.rectangle),this.rectangleinfoArray.push({point:this.rectanglePoints,info:this.markinfo}),this.realrectangleinfoArray.push({point:this.realRectanglePoints,info:this.markinfo}),this.fabricObj.remove(this.temRectangle[0]),this.fabricObj.add(this.rectangle),this.fabricObj.renderAll(),this.rectanglePoints=[],this.realRectanglePoints=[],this.rectangle=null,this.temRectangle=[],console.log("rectangleArray",this.rectangleArray),console.log("rectangleinfoArray",this.rectangleinfoArray),console.log("realrectangleinfoArray",this.realrectangleinfoArray),console.log("temRectangle",this.temRectangle[0]),this.islabeling&&(this.islabeling=!1)}else console.log("click repeat!!!")},makeRectangle:function(){if(console.log("rectanglePoints",this.rectanglePoints),this.rectanglePoints[0].x>this.rectanglePoints[1].x){var e=this.rectanglePoints[0].x;this.rectanglePoints[0].x=this.rectanglePoints[1].x,this.rectanglePoints[1].x=e}if(this.rectanglePoints[0].y>this.rectanglePoints[1].y){var i=this.rectanglePoints[0].y;this.rectanglePoints[0].y=this.rectanglePoints[1].y,this.rectanglePoints[1].y=i}if(this.realRectanglePoints[0].x>this.realRectanglePoints[1].x){var t=this.realRectanglePoints[0].x;this.realRectanglePoints[0].x=this.realRectanglePoints[1].x,this.realRectanglePoints[1].x=t}if(this.realRectanglePoints[0].y>this.realRectanglePoints[1].y){var r=this.realRectanglePoints[0].y;this.realRectanglePoints[0].y=this.realRectanglePoints[1].y,this.realRectanglePoints[1].y=r}var s=new f["fabric"].Rect({left:this.rectanglePoints[0].x,top:this.rectanglePoints[0].y,fill:this.markcolor,width:this.rectanglePoints[1].x-this.rectanglePoints[0].x,height:this.rectanglePoints[1].y-this.rectanglePoints[0].y,hasControls:!1,borderColor:"red",selectable:!1}),n=this;s.on("scaled",(function(){this.set({width:this.width*this.scaleX,height:this.height*this.scaleY,scaleX:1,scaleY:1}),console.log("suofangsuofang",this,n.rectangleinfoArray[n.rectangleArray.indexOf(this)],n.realrectangleinfoArray[n.rectangleArray.indexOf(this)]),n.rectangleinfoArray[n.rectangleArray.indexOf(this)].point[0].x=this.left,n.rectangleinfoArray[n.rectangleArray.indexOf(this)].point[0].y=this.top,n.rectangleinfoArray[n.rectangleArray.indexOf(this)].point[1].x=this.left+this.width,n.rectangleinfoArray[n.rectangleArray.indexOf(this)].point[1].y=this.top+this.height,n.realrectangleinfoArray[n.rectangleArray.indexOf(this)].point[0].x=this.left/n.scalewidth,n.realrectangleinfoArray[n.rectangleArray.indexOf(this)].point[0].y=this.top/n.scaleheight,n.realrectangleinfoArray[n.rectangleArray.indexOf(this)].point[1].x=(this.left+this.width)/n.scalewidth,n.realrectangleinfoArray[n.rectangleArray.indexOf(this)].point[1].y=(this.top+this.height)/n.scaleheight})),s.on("moved",(function(){console.log("yidong",this,n.rectangleinfoArray[n.rectangleArray.indexOf(this)],n.realrectangleinfoArray[n.rectangleArray.indexOf(this)]),n.rectangleinfoArray[n.rectangleArray.indexOf(this)].point[0].x=this.left,n.rectangleinfoArray[n.rectangleArray.indexOf(this)].point[0].y=this.top,n.rectangleinfoArray[n.rectangleArray.indexOf(this)].point[1].x=this.left+this.width,n.rectangleinfoArray[n.rectangleArray.indexOf(this)].point[1].y=this.top+this.height,n.realrectangleinfoArray[n.rectangleArray.indexOf(this)].point[0].x=this.left/n.scalewidth,n.realrectangleinfoArray[n.rectangleArray.indexOf(this)].point[0].y=this.top/n.scaleheight,n.realrectangleinfoArray[n.rectangleArray.indexOf(this)].point[1].x=(this.left+this.width)/n.scalewidth,n.realrectangleinfoArray[n.rectangleArray.indexOf(this)].point[1].y=(this.top+this.height)/n.scaleheight})),s.setControlsVisibility({mtr:!1}),s.type="rectangle",s.color=this.markcolor,s.info=this.markinfo,this.rectangle=s,console.log("this.rectangle",this.rectangle)},makeEllipseObj:function(e){if(e.absolutePointer.x!=this.ellipsePoints[0].x||e.absolutePointer.y!=this.ellipsePoints[0].y){var i={},t={};i["x"]=e.absolutePointer.x,i["y"]=e.absolutePointer.y,t["x"]=e.absolutePointer.x/this.scalewidth,t["y"]=e.absolutePointer.y/this.scaleheight,this.ellipsePoints.push(i),this.realEllipsePoints.push(t),this.makeEllipse(),this.ellipseArray.push(this.ellipse),this.allobjArray.push(this.ellipse),this.ellipseinfoArray.push({point:this.ellipsePoints,info:this.markinfo}),this.realellipseinfoArray.push({point:this.realEllipsePoints,info:this.markinfo}),this.fabricObj.remove(this.temEllipse[0]),this.fabricObj.add(this.ellipse),this.fabricObj.renderAll(),this.ellipsePoints=[],this.realEllipsePoints=[],this.ellipse=null,this.temEllipse=[],console.log("ellipseArray",this.ellipseArray),console.log("ellipseinfoArray",this.ellipseinfoArray),console.log("realellipseinfoArray",this.realellipseinfoArray),console.log("temEllipse",this.temEllipse[0]),this.islabeling&&(this.islabeling=!1)}else console.log("click repeat!!!")},makeEllipse:function(){if(console.log("ellipsePoints",this.ellipsePoints),this.ellipsePoints[0].x>this.ellipsePoints[1].x){var e=this.ellipsePoints[0].x;this.ellipsePoints[0].x=this.ellipsePoints[1].x,this.ellipsePoints[1].x=e}if(this.ellipsePoints[0].y>this.ellipsePoints[1].y){var i=this.ellipsePoints[0].y;this.ellipsePoints[0].y=this.ellipsePoints[1].y,this.ellipsePoints[1].y=i}if(this.ellipsePoints[0].x>this.ellipsePoints[1].x){var t=this.ellipsePoints[0].x;this.ellipsePoints[0].x=this.ellipsePoints[1].x,this.ellipsePoints[1].x=t}if(this.ellipsePoints[0].y>this.ellipsePoints[1].y){var r=this.ellipsePoints[0].y;this.ellipsePoints[0].y=this.ellipsePoints[1].y,this.ellipsePoints[1].y=r}var s=new f["fabric"].Ellipse({left:this.ellipsePoints[0].x,top:this.ellipsePoints[0].y,fill:this.markcolor,rx:(this.ellipsePoints[1].x-this.ellipsePoints[0].x)/2,ry:(this.ellipsePoints[1].y-this.ellipsePoints[0].y)/2,hasControls:!1,borderColor:"red",selectable:!1}),n=this;s.on("scaled",(function(){this.set({rx:this.rx*this.scaleX,ry:this.ry*this.scaleY,scaleX:1,scaleY:1}),console.log("suofangsuofang",this,n.ellipseinfoArray[n.ellipseArray.indexOf(this)],n.ellipseinfoArray[n.ellipseArray.indexOf(this)]),n.ellipseinfoArray[n.ellipseArray.indexOf(this)].point[0].x=this.left,n.ellipseinfoArray[n.ellipseArray.indexOf(this)].point[0].y=this.top,n.ellipseinfoArray[n.ellipseArray.indexOf(this)].point[1].x=this.left+2*this.rx,n.ellipseinfoArray[n.ellipseArray.indexOf(this)].point[1].y=this.top+2*this.ry,n.realellipseinfoArray[n.ellipseArray.indexOf(this)].point[0].x=this.left/n.scalewidth,n.realellipseinfoArray[n.ellipseArray.indexOf(this)].point[0].y=this.top/n.scaleheight,n.realellipseinfoArray[n.ellipseArray.indexOf(this)].point[1].x=(this.left+2*this.rx)/n.scalewidth,n.realellipseinfoArray[n.ellipseArray.indexOf(this)].point[1].y=(this.top+2*this.ry)/n.scaleheight})),s.on("moved",(function(){console.log("yidong",this,n.ellipseinfoArray[n.ellipseArray.indexOf(this)],n.ellipseinfoArray[n.ellipseArray.indexOf(this)]),n.ellipseinfoArray[n.ellipseArray.indexOf(this)].point[0].x=this.left,n.ellipseinfoArray[n.ellipseArray.indexOf(this)].point[0].y=this.top,n.ellipseinfoArray[n.ellipseArray.indexOf(this)].point[1].x=this.left+2*this.rx,n.ellipseinfoArray[n.ellipseArray.indexOf(this)].point[1].y=this.top+2*this.ry,n.realellipseinfoArray[n.ellipseArray.indexOf(this)].point[0].x=this.left/n.scalewidth,n.realellipseinfoArray[n.ellipseArray.indexOf(this)].point[0].y=this.top/n.scaleheight,n.realellipseinfoArray[n.ellipseArray.indexOf(this)].point[1].x=(this.left+2*this.rx)/n.scalewidth,n.realellipseinfoArray[n.ellipseArray.indexOf(this)].point[1].y=(this.top+2*this.ry)/n.scaleheight})),s.setControlsVisibility({mtr:!1}),s.type="ellipse",s.color=this.markcolor,s.info=this.markinfo,this.ellipse=s,console.log("this.ellipse",this.ellipse)},findcolor:function(e){var i=this;this.premarktype.forEach((function(t){console.log("infind",e),t.name===e&&(console.log("find",t.color,Object(h["a"])(t.color)),i.markcolor=t.color)}))},findTopPaddingForRoof:function(e){for(var i=999999,t=0;t<this.roofPoints.length;t++)e[t].y<i&&(i=e[t].y);return Math.abs(i)},findLeftPaddingForRoof:function(e){for(var i=999999,t=0;t<this.roofPoints.length;t++)e[t].x<i&&(i=e[t].x);return Math.abs(i)}}},d=u,g=(t("b7ba"),t("2877")),p=Object(g["a"])(d,a,c,!1,null,"af4cfff2",null),y=p.exports,b=(t("b775"),t("0b0d")),m=t("4360"),A=t("77c4"),v=t("d28d");function x(e){console.log("keydown!!!!!!!!!!!!");var i=e.event||window.event,t=i.keyCode||i.which||i.charCode;80==t&&(console.log("pppppppp!!!!!!!!!!!!!"),previousimage()),78==t&&(console.log("nnnnnnnn!!!!!!!!!!!!!"),nextimage()),81==t&&(console.log("qqqqqqqq!!!!!!!!!!!!!"),skipimage()),65===t&&this.pass(),68===t&&this.rejectDialog(),71===t&&this.reset()}var w={name:"Dashboard",components:{drawpolygon:y,miniimage:b["a"]},data:function(){return{isAudited:1,isCheckedAll:!1,checkedList:[],imageArry:[],infoArry:[],lastinfoArry:[],uuidArry:[],imagelargeArry:[],testmarktype:[{name:"car",color:"rgba(128,0,0,0.75)"},{name:"person",color:"rgba(0,128,0,0.75)"},{name:"human1",color:"rgba(0,0,128,0.75)"},{name:"human2",color:"rgba(128,128,0,0.75)"},{name:"human3",color:"rgba(0,128,128,0.75)"},{name:"human4",color:"rgba(128,0,128,0.75)"}],marktype:[],nopnum:0,unable:!1,nownum:0,isalllabeled:!1,starttimer:null,nowseconds:0,isdisablebutton:!1,isimageview:!0,automarkbtntext:"开始自动标注",isloading:!1,batchRejectDiaglogShow:!1,rejectDiaglogShow:!1,auditRemarks:"",auditRemark:""}},mounted:function(){var e=this;this.infoArry=new Array(this.imageArry.length),console.log("mounted!!!!",this.infoArry.length,this.infoArry),console.log("mounted!!!!uuid",m["a"].getters.uuid,"mounted!!!!store.getters.userid",m["a"].getters.userid),this.getAuditDataList(),this.getTags(),window.nextimage=this.nextimage,window.previousimage=this.previousimage,window.skipimage=this.skipimage,window.pass=this.pass,window.rejectDialog=this.rejectDialog,window.reset=this.reset,document.onkeydown=x,this.starttimer=setInterval((function(){if(e.nowseconds++,e.nowseconds>=6e4){console.log("超时");m["a"].getters.userId,m["a"].getters.dataSet.user_id,m["a"].getters.uuid;e.$store.dispatch("user/logout"),e.$router.push("/login?redirect=".concat(e.$route.fullPath)),location.reload()}}),1e3)},destroyed:function(){document.onkeydown=void 0,clearInterval(this.starttimer),this.starttimer=null,this.nowseconds=0},methods:{batchRejectDialog:function(){this.batchRejectDiaglogShow=!0,this.auditRemarks=""},rejectDialog:function(){this.rejectDiaglogShow=!0,this.auditRemark=""},submitBatchReject:function(){this.batchReject(),this.batchRejectDiaglogShow=!1},submitReject:function(){this.reject(),this.rejectDiaglogShow=!1},returndataset:function(){this.$router.push("/data")},pass:function(){var e=this;console.log(this.imagelargeArry);var i={labelUuid:this.uuidArry[this.nownum]};Object(A["g"])(i).then((function(i){e.$message({message:"审核通过",duration:300,type:"success"})})).catch((function(e){this.$message({message:"审核失败",duration:300,type:"error"})}))},reject:function(){var e=this,i={labelUuid:this.uuidArry[this.nownum],audit_remark:this.auditRemark};Object(A["i"])(i).then((function(i){e.$message({message:"驳回成功",duration:300,type:"success"}),e.rejectDiaglogShow=!1})).catch((function(e){this.$message({message:"驳回失败",duration:300,type:"error"})}))},reset:function(){var e=this,i={labelUuid:this.uuidArry[this.nownum]};Object(A["h"])(i).then((function(i){e.$message({message:"重置成功",duration:300,type:"success"}),e.getAuditDataList()})).catch((function(e){this.$message({message:"重置失败",duration:300,type:"error"})}))},addToList:function(e){console.log(e),-1==this.checkedList.indexOf(e)?this.checkedList.push(e):this.checkedList.splice(this.checkedList.indexOf(e),1)},checkedAll:function(){this.isCheckedAll=!this.isCheckedAll,this.isCheckedAll?(this.checkedList=[],this.imagelargeArry.forEach((function(e){this.checkedList.push(e.uuid)}),this)):this.checkedList=[]},batchSave:function(){var e=this;console.log(this.checkedList.join(","));var i={labelUuids:this.checkedList.join(",")};Object(A["c"])(i).then((function(i){e.$message({message:i.message,type:"success"}),e.getAuditDataList(),e.checkedList=[]}))},batchReject:function(){var e=this;console.log(this.checkedList.join(","));var i={labelUuids:this.checkedList.join(","),audit_remark:this.auditRemarks};Object(A["b"])(i).then((function(i){e.$message({message:i.message,type:"success"}),e.getAuditDataList(),e.checkedList=[],e.batchRejectDiaglogShow=!1}))},batchReSet:function(){var e=this;console.log(this.checkedList.join(","));var i={labelUuids:this.checkedList.join(",")};Object(A["a"])(i).then((function(i){e.$message({message:i.message,type:"success"}),e.getAuditDataList(),e.checkedList=[]}))},setAudited:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function i(){var t;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return t={labelUuid:e.uuidArry[e.nownum]},i.next=3,Object(A["f"])(t).then((function(i){e.isAudited=i.data.items}));case 3:case"end":return i.stop()}}),i)})))()},entermark:function(e){console.log("faaaaaaaaaaaatherenter!",this.nownum,this.uuidArry[this.nownum]),this.nownum=e,this.isimageview=!this.isimageview},returnimageview:function(){this.getAuditDataList(),this.getTags(),this.nownum=0,this.isimageview=!this.isimageview},nextimage:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,e.setAudited();case 2:if(console.log("llllokonojiojo",e.isAudited),1!=e.isAudited){i.next=7;break}e.$message("请进行审核操作"),i.next=12;break;case 7:if(!e.isimageview){i.next=10;break}return console.log("处于预览界面"),i.abrupt("return");case 10:e.nownum<e.imageArry.length-1&&e.nownum++,console.log("nextimage",e.nownum);case 12:case"end":return i.stop()}}),i)})))()},previousimage:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,e.setAudited();case 2:if(1!=e.isAudited){i.next=6;break}e.$message("请进行审核操作"),i.next=11;break;case 6:if(!e.isimageview){i.next=9;break}return console.log("处于预览界面"),i.abrupt("return");case 9:e.nownum>0&&e.nownum--,console.log("previousimage",e.nownum);case 11:case"end":return i.stop()}}),i)})))()},skipimage:function(){this.isimageview?console.log("处于预览界面"):this.isdisablebutton?console.log("您现在正在修改图片"):(this.nownum<this.imageArry.length-1&&this.nownum++,console.log("skipimage",this.nownum),this.nowseconds=0)},getAuditDataList:function(){var e=this;this.isalllabeled=!0,this.imageArry=[];var i={dataSetUuid:m["a"].getters.uuid,userId:m["a"].getters.userid};console.log(i),Object(A["e"])(i).then((function(i){e.imageArry=[],e.infoArry=[],e.lastinfoArry=[],e.uuidArry=[],e.imagelargeArry=[],e.auditinfoArry=[],e.acceptinfoArry=[],console.log("get图片结果",i);for(var t=0;t<i.data.items.length;t++){if(console.log("get items",[t],i.data.items[t]),e.auditinfoArry[t]=i.data.items[t].audit_remark,e.acceptinfoArry[t]=i.data.items[t].accept_remark,1!=i.data.items[t].is_label&&(e.isalllabeled=!1),void 0==i.data.items[t].label_data||"[]"===i.data.items[t].label_data)e.lastinfoArry.push({});else{var r=JSON.parse(i.data.items[t].label_data);console.log("tempa",r),e.lastinfoArry.push(r),console.log("lastinfoArry",e.lastinfoArry[t])}var s={};s["url"]=i.data.items[t].file_path,s["islabel"]=i.data.items[t].is_audit,s["uuid"]=i.data.items[t].uuid,e.imagelargeArry.push(s),e.uuidArry.push(i.data.items[t].uuid),e.imageArry.push(i.data.items[t].file_path)}})).catch((function(i){console.log("error",i),e.$message({message:"图片数量不足",duration:1e3,type:"error"})}))},getTags:function(){var e=this;this.marktype=[];var i={dataset_uuid:m["a"].getters.uuid};Object(v["a"])(i).then((function(i){for(var t=0;t<i.data.items.length;t++){var r={};r["name"]=i.data.items[t].name,r["color"]=i.data.items[t].color,e.marktype.push(r)}console.log("marktype",e.marktype)})).catch((function(i){console.log("error",i),e.$message({message:"请求标签集合失败",duration:1e3,type:"error"})}))}},computed:Object(n["a"])({},Object(l["b"])(["name"]))},k=w,O=(t("d4df"),Object(g["a"])(k,r,s,!1,null,"6a8be9be",null));i["default"]=O.exports},a15b:function(e,i,t){"use strict";var r=t("23e7"),s=t("44ad"),n=t("fc6a"),o=t("a640"),l=[].join,a=s!=Object,c=o("join",",");r({target:"Array",proto:!0,forced:a||!c},{join:function(e){return l.call(n(this),void 0===e?",":e)}})},b7ba:function(e,i,t){"use strict";t("6125")},d28d:function(e,i,t){"use strict";t.d(i,"a",(function(){return s})),t.d(i,"b",(function(){return n})),t.d(i,"c",(function(){return o}));var r=t("b775");function s(e){return Object(r["a"])({url:"/8082/dataset/tag",method:"get",params:e})}function n(e){return Object(r["a"])({url:"/8085/tag/saveTags",method:"post",data:e})}function o(e){return Object(r["a"])({url:"/8085/tag/updateTags",method:"put",data:e})}},d4df:function(e,i,t){"use strict";t("1a17")},e454:function(e,i,t){}}]);