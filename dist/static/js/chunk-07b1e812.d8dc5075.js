(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-07b1e812"],{"0b0d":function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"ih-item"},[i("a",[i("div",[i("img",{style:{height:"200px",border:"3px solid "+this.markcolor},attrs:{src:e.imagesrc},on:{mousedown:e.entermark}})]),i("div",{staticClass:"info",staticStyle:{"{width":"100%"}},[i("h3",{staticStyle:{color:"rgba(255,255,255,1)"}},[e._v(e._s(e.ismarkedtext))])])])])},s=[],n=(i("a9e3"),{name:"",data:function(){return{input:""}},props:{fatherimagesrc:String,ismarked:{type:Number,default:!1},ishighlight:Boolean},destroyed:function(){console.log("miniimageddddddddddddddddddddddddddddddddddddddddddddddddddddd")},computed:{imagesrc:function(){return this.fatherimagesrc},markcolor:function(){return 1===this.ismarked?"#ffffff":2===this.ismarked?"#ff0000":3===this.ismarked?"#ffff00":"#000000"},ismarkedtext:function(){return 2===this.ismarked?"已通过":3===this.ismarked?"已驳回":4===this.ismarked?"已重置":"未审核"}},methods:{kanurl:function(){console.log(this.imagesrc)},entermark:function(){console.log("entermark"),this.$emit("entermark")}},components:{}}),r=n,o=(i("665f"),i("2877")),c=Object(o["a"])(r,a,s,!1,null,null,null);t["a"]=c.exports},"1b25":function(e,t,i){},"1f79":function(e,t,i){},"665f":function(e,t,i){"use strict";i("e454")},"6b78":function(e,t,i){"use strict";i("1f79")},"6fd1":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{"user-select":"none"}},[e.isimageview?i("div",{staticClass:"dashboard-container"},[i("div",[i("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:e.returndataset}},[e._v("返回数据集")]),i("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:e.batchSave}},[e._v("批量通过")]),i("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:e.batchRejectDialog}},[e._v("批量不通过")]),i("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:e.batchReSet}},[e._v("批量重置")]),i("span",{staticClass:"checkAll"},[i("input",{attrs:{type:"checkbox"},domProps:{checked:e.checkedList.length===e.imagelargeArry.length},on:{change:function(t){return e.checkedAll()}}}),i("span",[e._v("全选")])])],1),e._l(e.imagelargeArry,(function(t,a){return i("div",{key:a,staticStyle:{display:"inline-block","margin-left":"20px"}},[i("div",[i("div",{staticStyle:{"margin-top":"20px"}},[i("input",{attrs:{type:"checkbox",name:""},domProps:{checked:-1!=e.checkedList.indexOf(t.uuid)},on:{change:function(i){return e.addToList(t.uuid)}}})]),i("miniimage",{staticStyle:{"margin-top":"1px"},attrs:{fatherimagesrc:t.url,ismarked:t.islabel},on:{entermark:function(t){return e.entermark(a)}}})],1)])}))],2):e._e(),e.isimageview?e._e():i("div",{staticClass:"dashboard-container",staticStyle:{"margin-left":"100px"}},[i("el-button",{on:{click:e.returnimageview}},[e._v("返回图片预览")]),i("el-button",{on:{click:e.nextimage}},[e._v("下一张(N)")]),i("el-button",{on:{click:e.previousimage}},[e._v("上一张(P)")]),i("el-button",{on:{click:e.pass}},[e._v("通过(A)")]),i("el-button",{on:{click:e.rejectDialog}},[e._v("驳回(D)")]),i("el-button",{on:{click:e.reset}},[e._v("重置(G)")]),i("imageselect",{ref:"imageselectref",staticStyle:{"margin-top":"20px"},attrs:{fatherimagesrc:this.imageArry[e.nownum],imageindex:this.nownum,premarktype:this.marktype,auditremakeinfo:this.auditinfoArry[e.nownum],acceptremakeinfo:this.acceptinfoArry[e.nownum],lastlabelArry:this.lastinfoArry[e.nownum]},on:{saveimageinfo:e.saveimageinfo}})],1),i("el-dialog",{attrs:{title:"驳回备注",visible:e.batchRejectDiaglogShow,width:"30%"},on:{"update:visible":function(t){e.batchRejectDiaglogShow=t}}},[i("el-input",{attrs:{placeholder:"请输入备注",clearable:""},model:{value:e.auditRemarks,callback:function(t){e.auditRemarks=t},expression:"auditRemarks"}}),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.batchRejectDiaglogShow=!1}}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:e.submitBatchReject}},[e._v("确 定")])],1)],1),i("el-dialog",{attrs:{title:"驳回备注",visible:e.rejectDiaglogShow,width:"30%"},on:{"update:visible":function(t){e.rejectDiaglogShow=t}}},[i("el-input",{attrs:{placeholder:"请输入备注",clearable:""},model:{value:e.auditRemark,callback:function(t){e.auditRemark=t},expression:"auditRemark"}}),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.rejectDiaglogShow=!1}}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:e.submitReject}},[e._v("确 定")])],1)],1)],1)},s=[],n=i("5530"),r=i("1da1"),o=(i("96cf"),i("a434"),i("159b"),i("a15b"),i("b0c0"),i("2f62")),c=i("7e1e"),u=i("e280"),l=(i("b775"),i("0b0d")),d=i("4360"),h=i("77c4"),m=i("d28d");function g(e){console.log("keydown!!!!!!!!!!!!");var t=e.event||window.event,i=t.keyCode||t.which||t.charCode;80===i&&(console.log("pppppppp!!!!!!!!!!!!!"),this.previousimage()),78===i&&(console.log("nnnnnnnn!!!!!!!!!!!!!"),this.nextimage()),81===i&&(console.log("qqqqqqqq!!!!!!!!!!!!!"),this.skipimage()),65===i&&this.pass(),68===i&&this.rejectDialog(),71===i&&this.reset()}var f={name:"Imageselect",components:{imageselect:u["a"],miniimage:l["a"]},data:function(){return{isAudited:0,isCheckedAll:!1,checkedList:[],imageArry:[],infoArry:[],lastinfoArry:[],uuidArry:[],imagelargeArry:[],testmarktype:[{name:"car",color:"rgba(128,0,0,0.75)"},{name:"person",color:"rgba(0,128,0,0.75)"},{name:"human1",color:"rgba(0,0,128,0.75)"},{name:"human2",color:"rgba(128,128,0,0.75)"},{name:"human3",color:"rgba(0,128,128,0.75)"},{name:"human4",color:"rgba(128,0,128,0.75)"}],marktype:[],unable:!1,nownum:0,isalllabeled:!1,starttimer:null,nowseconds:0,isimageview:!0,automarkbtntext:"开始自动标注",isloading:!1,batchRejectDiaglogShow:!1,rejectDiaglogShow:!1,auditRemarks:"",auditRemark:""}},destroyed:function(){document.onkeydown=void 0,clearInterval(this.starttimer),this.starttimer=null,this.nowseconds=0},mounted:function(){var e=this;console.log("mounted!!!!",this.infoArry.length,this.infoArry),console.log("mounted!!!!uuid",d["a"].getters.uuid,"mounted!!!!store.getters.userid",d["a"].getters.userid),this.getAuditDataList(),this.infoArry=new Array(this.imageArry.length),this.getTags(),window.nextimage=this.nextimage,window.previousimage=this.previousimage,window.skipimage=this.skipimage,window.pass=this.pass,window.rejectDialog=this.rejectDialog,window.reset=this.reset,document.onkeydown=g,this.starttimer=setInterval((function(){if(e.nowseconds++,e.nowseconds>=3e4){console.log("超时");var t={userId:d["a"].getters.userid,dataSetId:d["a"].getters.dataSet.user_id,dataSetUuid:d["a"].getters.uuid};Object(c["l"])(t),e.$store.dispatch("user/logout"),e.$router.push("/login?redirect=${this.$route.fullPath}"),location.reload()}}),1e3)},methods:{batchRejectDialog:function(){this.batchRejectDiaglogShow=!0,this.auditRemarks=""},rejectDialog:function(){this.rejectDiaglogShow=!0,this.auditRemark=""},submitBatchReject:function(){this.batchReject(),this.batchRejectDiaglogShow=!1},submitReject:function(){this.reject(),this.rejectDiaglogShow=!1},returndataset:function(){this.$router.push("/data")},out:function(){console.log(this.checkedList)},pass:function(){var e=this;this.isAudited=!0,console.log(this.imagelargeArry);var t={labelUuid:this.uuidArry[this.nownum]};Object(h["g"])(t).then((function(t){e.$message({message:"审核通过",duration:300,type:"success"})})).catch((function(e){this.$message({message:"审核失败",duration:300,type:"error"})}))},reject:function(){var e=this;this.isAudited=!0;var t={labelUuid:this.uuidArry[this.nownum],audit_remark:this.auditRemark};Object(h["i"])(t).then((function(t){e.$message({message:"驳回成功",duration:300,type:"success"}),e.rejectDiaglogShow=!1})).catch((function(e){this.$message({message:"驳回失败",duration:300,type:"error"})}))},reset:function(){var e=this;this.isAudited=!0;var t={labelUuid:this.uuidArry[this.nownum]};Object(h["h"])(t).then((function(t){e.$message({message:"重置成功",duration:300,type:"success"}),e.getAuditDataList()})).catch((function(e){this.$message({message:"重置失败",duration:300,type:"error"})}))},addToList:function(e){console.log(e),-1==this.checkedList.indexOf(e)?this.checkedList.push(e):this.checkedList.splice(this.checkedList.indexOf(e),1)},checkedAll:function(){this.isCheckedAll=!this.isCheckedAll,this.isCheckedAll?(this.checkedList=[],this.imagelargeArry.forEach((function(e){this.checkedList.push(e.uuid)}),this)):this.checkedList=[]},batchSave:function(){var e=this;console.log(this.checkedList.join(","));var t={labelUuids:this.checkedList.join(",")};Object(h["c"])(t).then((function(t){e.$message({message:t.message,type:"success"}),e.getAuditDataList(),e.checkedList=[]}))},batchReject:function(){var e=this;console.log(this.checkedList.join(","));var t={labelUuids:this.checkedList.join(","),audit_remark:this.auditRemarks};Object(h["b"])(t).then((function(t){e.$message({message:t.message,type:"success"}),e.getAuditDataList(),e.checkedList=[],e.batchRejectDiaglogShow=!1}))},batchReSet:function(){var e=this;console.log(this.checkedList.join(","));var t={labelUuids:this.checkedList.join(",")};Object(h["a"])(t).then((function(t){e.$message({message:t.message,type:"success"}),e.getAuditDataList(),e.checkedList=[]}))},entermark:function(e){console.log("faaaaaaaaaaaatherenter!",this.nownum),this.nownum=e,this.isimageview=!this.isimageview},returnimageview:function(){this.getAuditDataList(),this.getTags(),this.nownum=0,this.isimageview=!this.isimageview},markarray:function(e){this.infoArry=e,console.log("222"+this.infoArry)},newlabel:function(){var e=this;console.log("申请新图片"),console.log(d["a"].getters.userid);var t={id:d["a"].getters.userid,datasetuuid:d["a"].getters.dataSet.uuid};Object(c["j"])(t).then((function(t){e.requireimage()}))},setAudited:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i={labelUuid:e.uuidArry[e.nownum]},t.next=3,Object(h["f"])(i).then((function(t){e.isAudited=t.data.items}));case 3:case"end":return t.stop()}}),t)})))()},skipimage:function(){this.isimageview?console.log("处于预览界面"):(this.nownum<this.imageArry.length-1&&this.nownum++,console.log("skipimage",this.nownum),this.nowseconds=0)},nextimage:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.setAudited();case 2:if(1!=e.isAudited){t.next=6;break}e.$message("请进行审核操作"),t.next=11;break;case 6:if(!e.isimageview){t.next=9;break}return console.log("处于预览界面"),t.abrupt("return");case 9:e.nownum<e.imageArry.length-1&&e.nownum++,console.log("nextimage",e.nownum);case 11:case"end":return t.stop()}}),t)})))()},previousimage:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.setAudited();case 2:if(1!=e.isAudited){t.next=6;break}e.$message("请进行审核操作"),t.next=11;break;case 6:if(!e.isimageview){t.next=9;break}return console.log("处于预览界面"),t.abrupt("return");case 9:e.nownum>0&&e.nownum--,console.log("previousimage",e.nownum);case 11:case"end":return t.stop()}}),t)})))()},getAuditDataList:function(){var e=this;this.isalllabeled=!0,this.imageArry=[];var t={dataSetUuid:d["a"].getters.uuid,userId:d["a"].getters.userid};console.log(t),Object(h["e"])(t).then((function(t){e.imageArry=[],e.infoArry=[],e.lastinfoArry=[],e.uuidArry=[],e.imagelargeArry=[],e.auditinfoArry=[],e.acceptinfoArry=[],console.log("get图片结果",t);for(var i=0;i<t.data.items.length;i++){if(console.log("get items",[i],t.data.items[i]),e.auditinfoArry[i]=t.data.items[i].audit_remark,e.acceptinfoArry[i]=t.data.items[i].accept_remark,1!=t.data.items[i].is_label&&(e.isalllabeled=!1),void 0==t.data.items[i].label_data||"[]"===t.data.items[i].label_data)e.lastinfoArry.push({});else{var a=JSON.parse(t.data.items[i].label_data);console.log("tempa",a),e.lastinfoArry.push(a),console.log("lastinfoArry",e.lastinfoArry[i])}var s={};s["url"]=t.data.items[i].file_path,s["islabel"]=t.data.items[i].is_audit,s["uuid"]=t.data.items[i].uuid,e.imagelargeArry.push(s),e.uuidArry.push(t.data.items[i].uuid),e.imageArry.push(t.data.items[i].file_path)}})).catch((function(t){console.log("error",t),e.$message({message:"请求图片集合失败",duration:1e3,type:"error"})}))},getTags:function(){var e=this;this.marktype=[];var t={dataset_uuid:d["a"].getters.uuid};Object(m["a"])(t).then((function(t){for(var i=0;i<t.data.items.length;i++){var a={};a["name"]=t.data.items[i].name,a["color"]=t.data.items[i].color,e.marktype.push(a)}console.log("marktype",e.marktype)})).catch((function(t){console.log("error",t),e.$message({message:"请求标签集合失败",duration:1e3,type:"error"})}))}},computed:Object(n["a"])({},Object(o["b"])(["name"]))},p=f,k=(i("a187"),i("6b78"),i("2877")),b=Object(k["a"])(p,a,s,!1,null,"6fcec41c",null);t["default"]=b.exports},a187:function(e,t,i){"use strict";i("1b25")},e454:function(e,t,i){}}]);