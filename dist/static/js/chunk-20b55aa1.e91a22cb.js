(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-20b55aa1"],{2171:function(t,e,i){},"2aa2":function(t,e,i){"use strict";i("9786")},"56a2":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{"user-select":"none"}},[t.isimageview?i("div",{staticClass:"dashboard-container"},[i("div",[i("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:t.returndataset}},[t._v("返回数据集")]),i("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:t.batchSave}},[t._v("批量通过")]),i("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:t.batchUnAcceptDialog}},[t._v("批量不通过")]),i("span",{staticClass:"checkAll"},[i("input",{attrs:{type:"checkbox"},domProps:{checked:t.checkedList.length===t.imagelargeArry.length},on:{change:function(e){return t.checkedAll()}}}),i("span",[t._v("全选")])])],1),t._l(t.imagelargeArry,(function(e,a){return i("div",{key:a,staticStyle:{display:"inline-block","margin-left":"20px"}},[i("div",[i("div",{staticStyle:{"margin-top":"20px"}},[i("input",{attrs:{type:"checkbox",name:""},domProps:{checked:-1!=t.checkedList.indexOf(e.uuid)},on:{change:function(i){return t.addToList(e.uuid)}}})]),i("miniimage",{staticStyle:{"margin-top":"1px"},attrs:{fatherimagesrc:e.url,ismarked:e.islabel},on:{entermark:function(e){return t.entermark(a)}}})],1)])}))],2):t._e(),t.isimageview?t._e():i("div",{staticClass:"dashboard-container",staticStyle:{"margin-left":"100px"}},[i("el-button",{on:{click:t.returnimageview}},[t._v("返回图片预览")]),i("el-button",{on:{click:t.nextimage}},[t._v("下一张(N)")]),i("el-button",{on:{click:t.previousimage}},[t._v("上一张(P)")]),i("el-button",{on:{click:t.pass}},[t._v("通过(A)")]),i("el-button",{on:{click:t.unAcceptDialog}},[t._v("不通过(D)")]),i("imageselect",{ref:"imageselectref",staticStyle:{"margin-top":"20px"},attrs:{fatherimagesrc:this.imageArry[t.nownum],imageindex:this.nownum,premarktype:this.marktype,auditremakeinfo:this.auditinfoArry[t.nownum],acceptremakeinfo:this.acceptinfoArry[t.nownum],lastlabelArry:this.lastinfoArry[t.nownum]},on:{saveimageinfo:t.saveimageinfo}})],1),i("el-dialog",{attrs:{title:"不通过备注",visible:t.batchUnAcceptDialogShow,width:"30%"},on:{"update:visible":function(e){t.batchUnAcceptDialogShow=e}}},[i("el-input",{attrs:{placeholder:"请输入备注",clearable:""},model:{value:t.acceptRemark,callback:function(e){t.acceptRemark=e},expression:"acceptRemark"}}),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.batchUnAcceptDialogShow=!1}}},[t._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:t.submitBatchUnAccept}},[t._v("确 定")])],1)],1),i("el-dialog",{attrs:{title:"不通过备注",visible:t.unAcceptDialogShow,width:"30%"},on:{"update:visible":function(e){t.unAcceptDialogShow=e}}},[i("el-input",{attrs:{placeholder:"请输入备注",clearable:""},model:{value:t.acceptRemark,callback:function(e){t.acceptRemark=e},expression:"acceptRemark"}}),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.unAcceptDialogShow=!1}}},[t._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:t.submitUnAccept}},[t._v("确 定")])],1)],1)],1)},n=[],s=i("5530"),c=(i("a434"),i("159b"),i("a15b"),i("b0c0"),i("2f62")),o=i("e280"),r=i("fedd"),u=i("4360"),l=i("7e1e"),d=i("f684"),h=i("77c4"),m=i("d28d");function g(t){console.log("keydown!!!!!!!!!!!!");var e=t.event||window.event,i=e.keyCode||e.which||e.charCode;80===i&&(console.log("pppppppp!!!!!!!!!!!!!"),this.previousimage()),78===i&&(console.log("nnnnnnnn!!!!!!!!!!!!!"),this.nextimage()),81===i&&(console.log("qqqqqqqq!!!!!!!!!!!!!"),this.skipimage()),65===i&&this.pass(),68===i&&this.unAcceptDialog()}var p={name:"Imageselect",components:{imageselect:o["a"],miniimage:r["a"]},data:function(){return{isAudited:0,checkedList:[],isCheckedAll:!1,imageArry:[],infoArry:[],lastinfoArry:[],uuidArry:[],imagelargeArry:[],testmarktype:[{name:"car",color:"rgba(128,0,0,0.75)"},{name:"person",color:"rgba(0,128,0,0.75)"},{name:"human1",color:"rgba(0,0,128,0.75)"},{name:"human2",color:"rgba(128,128,0,0.75)"},{name:"human3",color:"rgba(0,128,128,0.75)"},{name:"human4",color:"rgba(128,0,128,0.75)"}],marktype:[],unable:!1,nownum:0,isalllabeled:!1,starttimer:null,nowseconds:0,isimageview:!0,automarkbtntext:"开始自动标注",isloading:!1,batchUnAcceptDialogShow:!1,acceptRemarks:"",unAcceptDialogShow:!1,acceptRemark:""}},mounted:function(){var t=this;console.log("mounted!!!!",this.infoArry.length,this.infoArry),console.log("mounted!!!!uuid",u["a"].getters.uuid,"mounted!!!!store.getters.userid",u["a"].getters.userid),this.getAcceptDataList(),this.infoArry=new Array(this.imageArry.length),this.getTags(),window.nextimage=this.nextimage,window.previousimage=this.previousimage,window.skipimage=this.skipimage,window.unAcceptDialog=this.unAcceptDialog,window.pass=this.pass,document.onkeydown=g,this.starttimer=setInterval((function(){if(t.nowseconds++,t.nowseconds>=3e4){console.log("超时");var e={userId:u["a"].getters.userid,dataSetId:u["a"].getters.dataSet.user_id,dataSetUuid:u["a"].getters.uuid};Object(l["l"])(e),t.$store.dispatch("user/logout"),t.$router.push("/login?redirect=${this.$route.fullPath}"),location.reload()}}),1e3)},destroyed:function(){document.onkeydown=void 0,clearInterval(this.starttimer),this.starttimer=null,this.nowseconds=0},methods:{unAcceptDialog:function(){this.unAcceptDialogShow=!0,this.acceptRemark=""},submitUnAccept:function(){this.unAccept(),this.unAcceptDialogShow=!1},batchUnAcceptDialog:function(){this.batchUnAcceptDialogShow=!0,this.acceptRemarks=""},submitBatchUnAccept:function(){this.batchUnAccept(),this.batchUnAcceptDialogShow=!1},returndataset:function(){this.$router.push("/data")},out:function(){console.log(this.checkedList)},pass:function(){var t=this;this.isAudited=!0,console.log(this.imagelargeArry);var e={labelUuid:this.uuidArry[this.nownum],dataset_id:u["a"].getters.uuid};Object(d["a"])(e).then((function(e){t.$message({message:"验收通过",duration:300,type:"success"})})).catch((function(t){this.$message({message:"验收失败",duration:300,type:"error"})}))},unAccept:function(){var t=this;this.isAudited=!0;var e={labelUuid:this.uuidArry[this.nownum],dataset_id:u["a"].getters.uuid,accept_remark:this.acceptRemark};Object(d["g"])(e).then((function(e){t.$message({message:"验收不通过成功",duration:300,type:"success"}),t.unAcceptDialogShow=!1})).catch((function(t){this.$message({message:"验收不通过失败",duration:300,type:"error"})}))},addToList:function(t){console.log(t),-1===this.checkedList.indexOf(t)?this.checkedList.push(t):this.checkedList.splice(this.checkedList.indexOf(t),1)},checkedAll:function(){this.isCheckedAll=!this.isCheckedAll,this.isCheckedAll?(this.checkedList=[],this.imagelargeArry.forEach((function(t){this.checkedList.push(t.uuid)}),this)):this.checkedList=[]},batchSave:function(){var t=this;console.log(this.checkedList.join(","));var e={labelUuids:this.checkedList.join(","),dataset_id:u["a"].getters.uuid};Object(d["b"])(e).then((function(e){t.$message({message:e.message,type:"success"}),t.getAcceptDataList(),t.checkedList=[]}))},batchUnAccept:function(){var t=this;console.log(this.checkedList.join(","));var e={labelUuids:this.checkedList.join(","),dataset_id:u["a"].getters.uuid,accept_remark:this.acceptRemarks};Object(d["c"])(e).then((function(e){t.$message({message:e.message,type:"success"}),t.getAcceptDataList(),t.checkedList=[],t.batchUnAcceptDialogShow=!1}))},entermark:function(t){console.log("faaaaaaaaaaaatherenter!"),this.nownum=t,this.isimageview=!this.isimageview},returnimageview:function(){this.getAcceptDataList(),this.getTags(),this.nopnum=0,this.isimageview=!this.isimageview},markarray:function(t){this.infoArry=t,console.log("222"+this.infoArry)},setAudited:function(){var t=this,e={labelUuid:this.uuidArry[this.nownum]};Object(h["f"])(e).then((function(e){t.isAudited=e.data.items}))},skipimage:function(){this.isimageview?console.log("处于预览界面"):(this.nownum<this.imageArry.length-1&&this.nownum++,console.log("skipimage",this.nownum),this.nowseconds=0)},nextimage:function(){this.isimageview?console.log("处于预览界面"):(this.nownum<this.imageArry.length-1&&this.nownum++,console.log("nextimage",this.nownum))},previousimage:function(){this.isimageview?console.log("处于预览界面"):(this.nownum>0&&this.nownum--,console.log("previousimage",this.nownum))},getAcceptDataList:function(){var t=this;this.isalllabeled=!0,this.imageArry=[];var e={dataSetUuid:u["a"].getters.uuid,userId:u["a"].getters.userid};console.log(e),Object(d["e"])(e).then((function(e){t.imageArry=[],t.infoArry=[],t.lastinfoArry=[],t.uuidArry=[],t.imagelargeArry=[],t.auditinfoArry=[],t.acceptinfoArry=[],console.log("get图片结果",e);for(var i=0;i<e.data.items.length;i++){if(console.log("get items",[i],e.data.items[i]),t.auditinfoArry[i]=e.data.items[i].audit_remark,t.acceptinfoArry[i]=e.data.items[i].accept_remark,1!=e.data.items[i].is_label&&(t.isalllabeled=!1),void 0==e.data.items[i].label_data||"[]"===e.data.items[i].label_data)t.lastinfoArry.push({});else{var a=JSON.parse(e.data.items[i].label_data);console.log("tempa",a),t.lastinfoArry.push(a),console.log("lastinfoArry",t.lastinfoArry[i])}var n={};n["url"]=e.data.items[i].file_path,n["islabel"]=e.data.items[i].is_accept,n["uuid"]=e.data.items[i].uuid,t.imagelargeArry.push(n),t.uuidArry.push(e.data.items[i].uuid),t.imageArry.push(e.data.items[i].file_path)}})).catch((function(e){console.log("error",e),t.$message({message:"图片数据为0，重新设置验收比例",duration:1e3,type:"error"})}))},getTags:function(){var t=this;this.marktype=[];var e={dataset_uuid:u["a"].getters.uuid};Object(m["a"])(e).then((function(e){for(var i=0;i<e.data.items.length;i++){var a={};a["name"]=e.data.items[i].name,a["color"]=e.data.items[i].color,t.marktype.push(a)}console.log("marktype",t.marktype)})).catch((function(e){console.log("error",e),t.$message({message:"请求标签集合失败",duration:1e3,type:"error"})}))}},computed:Object(s["a"])({},Object(c["b"])(["name"]))},f=p,k=(i("2aa2"),i("7578"),i("2877")),A=Object(k["a"])(f,a,n,!1,null,"79d03a09",null);e["default"]=A.exports},7578:function(t,e,i){"use strict";i("d406")},9786:function(t,e,i){},af0d:function(t,e,i){"use strict";i("2171")},d406:function(t,e,i){},f684:function(t,e,i){"use strict";i.d(e,"d",(function(){return n})),i.d(e,"f",(function(){return s})),i.d(e,"e",(function(){return c})),i.d(e,"b",(function(){return o})),i.d(e,"c",(function(){return r})),i.d(e,"a",(function(){return u})),i.d(e,"g",(function(){return l}));var a=i("b775");function n(t){return Object(a["a"])({url:"/8085/userAccept/getAccepts",method:"get",params:t})}function s(t){return Object(a["a"])({url:"/8085/userAccept/set",method:"post",params:t})}function c(t){return Object(a["a"])({url:"/8085/userAccept/getAcceptData",method:"get",params:t})}function o(t){return Object(a["a"])({url:"/8085/userAccept/batchAccept",method:"put",params:t})}function r(t){return Object(a["a"])({url:"/8085/userAccept/batchUnAccept",method:"put",params:t})}function u(t){return Object(a["a"])({url:"/8085/userAccept/isAccept",method:"put",params:t})}function l(t){return Object(a["a"])({url:"/8085/userAccept/unAccept",method:"put",params:t})}},fedd:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"ih-item"},[i("a",[i("div",[i("img",{style:{height:"200px",border:"3px solid "+this.markcolor},attrs:{src:t.imagesrc},on:{mousedown:t.entermark}})]),i("div",{staticClass:"info",staticStyle:{"{width":"100%"}},[i("h3",{staticStyle:{color:"rgba(255,255,255,1)"}},[t._v(t._s(t.ismarkedtext))])])])])},n=[],s=(i("a9e3"),{name:"",data:function(){return{input:""}},props:{fatherimagesrc:String,ismarked:{type:Number,default:!1},ishighlight:Boolean},destroyed:function(){console.log("miniimageddddddddddddddddddddddddddddddddddddddddddddddddddddd")},computed:{imagesrc:function(){return this.fatherimagesrc},markcolor:function(){return 1===this.ismarked?"#000000":2===this.ismarked?"#ff0000":3===this.ismarked?"#ffff00":"#ffffff"},ismarkedtext:function(){return 1===this.ismarked?"已通过":2===this.ismarked?"未通过":3===this.ismarked?"已重置":"未验收"}},methods:{kanurl:function(){console.log(this.imagesrc)},entermark:function(){console.log("entermark"),this.$emit("entermark")}},components:{}}),c=s,o=(i("af0d"),i("2877")),r=Object(o["a"])(c,a,n,!1,null,null,null);e["a"]=r.exports}}]);